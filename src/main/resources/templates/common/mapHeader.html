<header th:fragment="header" xmlns:th="http://www.thymeleaf.org">
    <meta charset="UTF-8">

    <div id="header-id" class="w-full h-[100px] box-border fixed top-0 left-0 z-50 bg-white transition-all duration-300">
        <div id="header-wrapper" class="w-full h-[100px] flex items-start justify-between transition-all duration-300">
            <div class="w-[240px] h-[100px] flex justify-start items-start">
                <a href="../home/main" class="h-full flex items-center">
                    <img src="/images/로고.png" class="w-[240px] h-[100px] object-cover cursor-pointer" />
                </a>
            </div>

            <nav class="w-[60%] text-center">
                <ul id="nav-list" class="flex justify-center items-center relative space-x-4">
                    <!-- 상권 분석 -->
                    <li class="relative group w-[240px]">
                        <div class="flex justify-center items-center w-full h-[100px] cursor-pointer">
                            <p class="text-[22px] text-black">상권 분석</p>
                        </div>
                        <ul class="sub-menu absolute flex flex-col items-center top-full left-1/2 transform -translate-x-1/2 hidden bg-white w-full z-10 text-center">
                            <li class="w-full">
                                <a href="../map/commercialZoneMap"
                                   class="block px-4 py-2 hover:underline">지도 분석</a>
                            </li>
                            <li class="w-full">
                                <a href="../map/riskMap"
                                   class="block px-4 py-2 hover:underline">위험도 분석</a>
                            </li>
                        </ul>
                    </li>

                    <!-- 부동산 매물 -->
                    <li class="flex justify-center items-center w-[240px] h-[100px] relative">
                        <p class="text-[22px] text-black">부동산 매물</p>
                    </li>

                    <!-- 상가 청약 -->
                    <li class="relative group w-[240px]">
                        <div class="flex justify-center items-center w-full h-[100px] cursor-pointer">
                            <p class="text-[22px] text-black">상가 청약</p>
                        </div>
                        <ul class="sub-menu absolute flex-col items-center top-full left-1/2 transform -translate-x-1/2 hidden bg-white w-full z-10 text-center">
                            <li>
                                <a href="../home/notifications" class="block px-4 py-2 hover:underline">청약 알림</a>
                            </li>
                            <li>
                                <a href="../lh/notice" class="block px-4 py-2 hover:underline">공고문</a>
                            </li>
                        </ul>
                    </li>

                    <!-- 로그인 -->
                    <li class="relative group">
                        <ul>
                            <li th:if="${rq != null and rq.isLogout()}">
                                <a href="../member/joinAndLogin"
                                   class="flex justify-center items-center w-[240px] h-[100px] relative cursor-pointer">
                                    <p class="text-[22px] text-black">로그인</p>
                                </a>
                            </li>
                            <li th:if="${rq != null and rq.isLogined()}">
                                <a href="../member/conditionalLogout"
                                   class="flex justify-center items-center w-[160px] h-[100px] relative cursor-pointer">
                                    <p class="text-[22px] text-black">로그아웃</p>
                                </a>
                            </li>
                        </ul>
                    </li>

                    <!-- 알림 아이콘 + 팝업 -->
                    <li id="notif-wrapper" class="relative group" th:if="${rq != null and rq.isLogined()}">
                        <!-- 알림벨 버튼 -->
                        <button id="notif-icon" type="button" class="cursor-pointer select-none w-[80px] h-[100px]">
                            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24">
                                <g fill="none" stroke="#444" stroke-linecap="round" stroke-linejoin="round"
                                   stroke-width="2">
                                    <path stroke-dasharray="4" stroke-dashoffset="4" d="M12 3v2">
                                        <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.2s"
                                                 values="4;0"/>
                                    </path>
                                    <path fill="#444" fill-opacity="0" stroke-dasharray="28" stroke-dashoffset="28"
                                          d="M12 5c-3.31 0 -6 2.69 -6 6l0 6c-1 0 -2 1 -2 2h8M12 5c3.31 0 6 2.69 6 6l0 6c1 0 2 1 2 2h-8">
                                        <animate fill="freeze" attributeName="fill-opacity" begin="0.9s" dur="0.5s"
                                                 values="0;1"/>
                                        <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.2s" dur="0.4s"
                                                 values="28;0"/>
                                    </path>
                                    <path stroke-dasharray="8" stroke-dashoffset="8"
                                          d="M10 20c0 1.1 0.9 2 2 2c1.1 0 2 -0.9 2 -2">
                                        <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s"
                                                 values="8;0"/>
                                    </path>
                                </g>
                            </svg>
                        </button>

                        <!-- 팝업 알림함 불러오기 -->
                        <div th:replace="common/subscription :: subscription"></div>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

    <script>
        const headerId = document.getElementById('header-id');
        const header = document.getElementById('header-wrapper');
        const navList = document.getElementById('nav-list');
        const subMenus = document.querySelectorAll('.sub-menu');

        let hoverTimeout;

        const expandHeader = () => {
            clearTimeout(hoverTimeout);
            headerId.classList.remove('h-[100px]');
            headerId.classList.add('h-[250px]');
            header.classList.remove('h-[100px]');
            header.classList.add('h-[250px]');
            subMenus.forEach(menu => {
                menu.classList.remove('hidden');
                menu.classList.add('flex');
            });
        };

        const collapseHeader = () => {
            hoverTimeout = setTimeout(() => {
                headerId.classList.remove('h-[250px]');
                headerId.classList.add('h-[100px]');
                header.classList.remove('h-[250px]');
                header.classList.add('h-[100px]');
                subMenus.forEach(menu => {
                    menu.classList.remove('flex');
                    menu.classList.add('hidden');
                });
            }, 100);
        };

        navList.addEventListener('mouseenter', expandHeader);
        navList.addEventListener('mouseleave', collapseHeader);
    </script>
</header>
