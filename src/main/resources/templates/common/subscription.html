<!-- 팝업 알림함 -->
<div th:fragment="subscription" xmlns:th="http://www.thymeleaf.org"
     id="notif-popover"
     class="hidden absolute right-0 top-full mt-2 w-[380px] max-h-[520px] overflow-hidden bg-white rounded-2xl shadow-2xl border border-gray-200 z-[9999]">

    <!-- 꼬리 삼각형 -->
    <div class="absolute -top-2 right-6 w-0 h-0 border-l-8 border-r-8 border-b-8 border-l-transparent border-r-transparent border-b-white"></div>

    <!-- 팝업 헤더 -->
    <header class="px-4 py-3 flex items-center justify-between border-b">
        <h3 class="text-[15px] font-semibold">알림함</h3>
        <div class="flex items-center gap-2">
            <a href="../home/notifications"
               class="text-xs px-2 py-1 rounded bg-blue-600 text-white hover:opacity-90">
                전체 보기
            </a>
            <button id="notif-close" class="ml-1 p-1 rounded hover:bg-gray-100" aria-label="닫기">
                <svg width="18" height="18" viewBox="0 0 24 24"><path fill="currentColor" d="M6.4 4.98L12 10.6l5.6-5.62l1.42 1.42L13.42 12l5.6 5.6l-1.42 1.42L12 13.42l-5.6 5.6L5 17.6l5.6-5.6L5 6.4z"/></svg>
            </button>
        </div>
    </header>

    <!-- 스크롤 영역 -->
    <div class="max-h-[460px] overflow-auto bg-[#f7f8fa] px-3 py-3">
        <div id="notif-list" class="space-y-4">
            <!-- 날짜 구분선 -->
            <div class="relative flex items-center my-2">
                <div class="flex-1 h-px bg-gray-200"></div>
                <div class="px-3 text-xs text-gray-500"
                     th:text="|오늘 ${#temporals.format(T(java.time.LocalDateTime).now(), 'yy년 MM월 dd일 (E)', T(java.util.Locale).KOREAN)}|">
                </div>
                <div class="flex-1 h-px bg-gray-200"></div>
            </div>

            <!-- 알림 목록 -->
            <div class="max-h-[460px] overflow-auto bg-[#f7f8fa] px-3 py-3">
                <div class="space-y-4">

                    <!-- 관심일정 반복 -->
                    <article th:each="schedule : ${lhSupplySchedules}"
                             class="bg-white rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex items-start gap-3 p-4">
                            <div class="mt-0.5 flex h-8 w-8 items-center justify-center rounded-full bg-purple-100 text-purple-600">
                                <svg width="18" height="18" viewBox="0 0 24 24" class="fill-current">
                                    <path d="M7 2h2v2h6V2h2v2h3a1 1 0 0 1 1 1v4H3V5a1 1 0 0 1 1-1h3V2zm14 8v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-9h18zM7 14h4v4H7v-4z"/>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <div class="text-[12px] text-gray-500">관심 일정</div>
                                <h4 class="mt-0.5 text-[14px] font-semibold leading-snug"
                                    th:text="${schedule.name}">일정 제목</h4>
                                <p class="mt-1 text-[13px] text-gray-600"
                                   th:text="|신청 기간: ${#temporals.format(schedule.applyStart, 'yyyy년 MM월 dd일')} ~ ${#temporals.format(schedule.applyEnd, 'yyyy년 MM월 dd일')}|">
                                    기간
                                </p>
                            </div>
                        </div>
                    </article>

                    <!-- 관심일정이 없을 때 -->
                    <p th:if="${#lists.isEmpty(lhSupplySchedules)}"
                       class="text-center text-gray-500 py-4">
                        관심 등록된 일정이 없습니다.
                    </p>
                </div>
            </div>

            <!-- 이전 날짜 예시 -->
            <div class="relative flex items-center my-3">
                <div class="flex-1 h-px bg-gray-200"></div>
                <div class="px-3 text-xs text-gray-500"
                     th:text="|어제 ${#temporals.format(T(java.time.LocalDateTime).now().minusDays(1), 'yy년 MM월 dd일 (E)', T(java.util.Locale).KOREAN)}|">
                </div>
                <div class="flex-1 h-px bg-gray-200"></div>
            </div>

            <article class="bg-white rounded-2xl shadow-sm border border-gray-100">
                <div class="flex items-start gap-3 p-4">
                    <div class="mt-0.5 flex h-8 w-8 items-center justify-center rounded-full bg-purple-100 text-purple-600">
                        <svg width="18" height="18" viewBox="0 0 24 24" class="fill-current"><path d="M7 2h2v2h6V2h2v2h3a1 1 0 0 1 1 1v4H3V5a1 1 0 0 1 1-1h3V2zm14 8v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-9h18zM7 14h4v4H7v-4z"/></svg>
                    </div>
                    <div class="flex-1">
                        <div class="text-[12px] text-gray-500">(설명)</div>
                        <h4 class="mt-0.5 text-[14px] font-semibold leading-snug">제목</h4>
                        <p class="mt-1 text-[13px] text-gray-600">내용</p>
                    </div>
                    <div class="self-center text-gray-300">
                        <svg width="18" height="18" viewBox="0 0 24 24" class="fill-current"><path d="M9 6l6 6-6 6"/></svg>
                    </div>
                </div>
            </article>
        </div>
    </div>
</div>
