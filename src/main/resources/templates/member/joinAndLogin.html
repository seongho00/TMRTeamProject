<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/head::head"></head>

<script>
    // ë¹„ë°€ë²ˆí˜¸ ëˆˆ ëˆ„ë¥´ë©´ ë³´ì´ê²Œí•˜ê¸°
    function showPassword(el) {
        const $icon = $(el);

        // ê°€ì¥ ê°€ê¹Œìš´ ë¶€ëª¨ ì¤‘ì—ì„œ labelì´ ìˆëŠ” ìª½ì—ì„œ inputì„ ì°¾ëŠ”ë‹¤
        const $input = $icon.closest("div").find("label").find("input");
        const currentType = $input.attr("type");

        console.log("ì‹¤í–‰ë¨");
        if (currentType === "password") {
            $input.attr("type", "text");
            $(el).removeClass("fa-eye").addClass("fa-eye-slash");
        } else {
            $input.attr("type", "password");
            $(el).removeClass("fa-eye-slash").addClass("fa-eye");
        }
    }

    // ì´ë¦„ input ìœ íš¨ì„± ê²€ì‚¬
    function checkName(isSubmit = false) {
        const $input = $("#name");
        const $msg = $(".nameCheck-msg")
        const val = $input.val();
        const $line = $("#nameLine path");
        const nameRegex = /^([ê°€-í£]{2,20}|[a-zA-Z]{2,20}(?:\s[a-zA-Z]{2,20})*)$/;
        const hasKoreanWithSpace = /[ê°€-í£]+\s+[ê°€-í£]+/;

        $msg.removeClass("hidden");
        $line.attr("stroke", "red");
        $line.attr("stroke-opacity", "1");
        $input.addClass("placeholder-red-500");

        if (val.length === 0) {
            $msg.html("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;

        } else if (hasKoreanWithSpace.test(val)) {
            $msg.html("í•œê¸€ ì´ë¦„ì—ëŠ” ê³µë°±ì„ í¬í•¨í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            if (isSubmit) alert("í•œê¸€ ì´ë¦„ì—ëŠ” ê³µë°±ì„ í¬í•¨í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            return false;
        } else if (!nameRegex.test(val)) {
            $msg.html("ì´ë¦„ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            if (isSubmit) alert("ì´ë¦„ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else {
            $line.attr("stroke", "#1A1717");
            $line.attr("stroke-opacity", "0.38");
            $input.removeClass("placeholder-red-500");
            $msg.addClass("hidden");
            return true;
        }
    }

    // ì´ë©”ì¼ input ìœ íš¨ì„± ê²€ì‚¬
    function checkEmail(isSubmit = false) {
        const $input = $("#email");
        const $msg = $(".emailCheck-msg")
        const val = $input.val();
        const $line = $("#emailLine path");
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        $msg.removeClass("hidden");
        $line.attr("stroke", "red");
        $line.attr("stroke-opacity", "1");
        $input.addClass("placeholder-red-500");
        if (val.length === 0) {
            $msg.html("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else if (!emailRegex.test(val)) {
            $msg.html("ì´ë©”ì¼ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ì´ë©”ì¼ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else {
            $line.attr("stroke", "#1A1717");
            $line.attr("stroke-opacity", "0.38");
            $input.removeClass("placeholder-red-500");
            $msg.addClass("hidden");
            return true;
        }
    }

    // ë¹„ë°€ë²ˆí˜¸ input ìœ íš¨ì„± ê²€ì‚¬
    function checkPassword(isSubmit = false) {
        const $input = $("#joinPw")
        const $msg = $(".passwordCheck-msg")
        const val = $input.val();
        const $line = $("#passwordLine path");
        const pwRegex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[!@#$%^&*()_+=\-{}[\]:;"'<>,.?/~`])[A-Za-z\d!@#$%^&*()_+=\-{}[\]:;"'<>,.?/~`]{8,20}$/;

        $msg.removeClass("hidden");
        $line.attr("stroke", "red");
        $line.attr("stroke-opacity", "1");
        $input.addClass("placeholder-red-500");
        if (val.length === 0) {
            $msg.html("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else if (!pwRegex.test(val)) {
            $msg.html("ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ 8~20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            if (isSubmit) alert("ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ í¬í•¨í•´ 8~20ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else {
            $line.attr("stroke", "#1A1717");
            $line.attr("stroke-opacity", "0.38");
            $input.removeClass("placeholder-red-500");
            $msg.addClass("hidden");
            return true;
        }
    }

    // ì „í™”ë²ˆí˜¸ input ìœ íš¨ì„± ê²€ì‚¬
    function checkPhoneNum(isSubmit = false) {
        const $input = $("#phoneNum")
        const $msg = $(".phoneNumCheck-msg")
        const val = $input.val();
        const $line = $("#phoneNumLine path");

        $msg.removeClass("hidden");
        $line.attr("stroke", "red");
        $line.attr("stroke-opacity", "1");
        $input.addClass("placeholder-red-500");
        if (val.length === 0) {
            $msg.html("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ì „í™”ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else if (val.length < 13) {
            $msg.html("ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.")
            if (isSubmit) alert("ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return false;
        } else {
            $line.attr("stroke", "#1A1717");
            $line.attr("stroke-opacity", "0.38");
            $input.removeClass("placeholder-red-500");
            $msg.addClass("hidden");
            return true;
        }
    }


    $(document).ready(function () {

        // input ì¹¸ì—ì„œ ë§ˆìš°ìŠ¤ ë—ì„ ë•Œ
        $("#name").on("blur", function () {
            checkName(false);
        });
        $("#email").on("blur", function () {
            checkEmail(false);
        });
        $("#joinPw").on("blur", function () {
            checkPassword(false);
        });


        // ë²ˆí˜¸ input ê´€ë ¨ ì½”ë“œ
        $("#phoneNum")
            // "-" ì¶”ê°€í•´ì£¼ê¸°
            .on("input", function () {
                let num = $(this).val().replace(/[^0-9]/g, "");
                if (num.length < 4) {
                    $(this).val(num);
                } else if (num.length < 8) {
                    $(this).val(num.slice(0, 3) + "-" + num.slice(3));
                } else {
                    $(this).val(num.slice(0, 3) + "-" + num.slice(3, 7) + "-" + num.slice(7, 11));
                }
            })
            // ì•„ë¬´ê²ƒë„ ì…ë ¥ ì•ˆ í–ˆì„ ë•Œ ê²½ê³ í•´ì£¼ê¸°
            .on("blur", function () {
                checkPhoneNum(false);
            });


    });

    // join submit ëˆŒë €ì„ ë–„
    function handleSubmit(e) {
        e.preventDefault(); // ì „ì†¡ ë§‰ê¸°

        const isValid =
            checkName(true) &&
            checkEmail(true) &&
            checkPassword(true) &&
            checkPhoneNum(true);

        if (isValid) {
            $("#createAccountForm").submit(); // âœ… ìˆ˜ë™ ì œì¶œ
        }
    }

    // login submit ëˆŒë €ì„ ë–„
    function handleLoginSubmit(e) {
        e.preventDefault(); // ì „ì†¡ ë§‰ê¸°

        const email = $('#loginEmail').val();
        const loginPw = $('#loginPw').val();

        // ìœ íš¨ì„± ê²€ì‚¬ ë“± ê°€ëŠ¥
        if (!email) {
            alert("ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.");
            return;
        }

        if (!loginPw) {
            alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”");
            return;
        }

        $("#loginForm").submit(); // âœ… ìˆ˜ë™ ì œì¶œ
    }

    function toggleDiv() {
        const $joinDiv = $('.joinDiv');
        const $loginDiv = $('.loginDiv');

        // ëŒ€ìƒì´ ë‚˜íƒ€ë‚  ë•Œë§Œ ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ë¶€ì—¬
        if ($joinDiv.hasClass('hidden')) {
            $joinDiv.removeClass('hidden').addClass('animate-popup');
            $loginDiv.addClass('hidden').removeClass('animate-popup');
        } else {
            $loginDiv.removeClass('hidden').addClass('animate-popup');
            $joinDiv.addClass('hidden').removeClass('animate-popup');
        }

        // ì• ë‹ˆë©”ì´ì…˜ í´ë˜ìŠ¤ ì œê±°í•´ì„œ ë°˜ë³µ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ
        setTimeout(() => {
            $joinDiv.removeClass('animate-popup');
            $loginDiv.removeClass('animate-popup');
        }, 400);
    }

</script>

<style>
    /* ì• ë‹ˆë©”ì´ì…˜ ì½”ë“œ ì¶”ê°€ */
    .animate-popup {
        animation: animateLogin 0.4s ease;
    }

    @keyframes animateLogin {
        0% {
            transform: scale(1, 1);
        }
        50% {
            transform: scale(1.1, 1.1);
        }
        100% {
            transform: scale(1, 1);
        }
    }
</style>

<div class="flex flex-col justify-center items-center w-screen h-screen overflow-hidden gap-2.5 px-[75px] py-[50px] bg-white">
    <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 w-[1326px] h-[884px] relative"
         style="filter: drop-shadow(4px 4px 4px rgba(0,0,0,0.25));">
        <img src="/images/ë¡œê·¸ì¸ ë°°ê²½ì‚¬ì§„.png" class="flex-grow-0 flex-shrink-0 w-[1326px] h-[883px] object-cover"/>
        <div class="hidden joinDiv flex flex-col justify-center items-center flex-grow-0 flex-shrink-0 h-[883px] w-[607px] absolute left-[719px] top-0 overflow-hidden gap-[30px] py-[11px] rounded-tl-3xl rounded-bl-3xl bg-white"
             style="box-shadow: 4px 4px 4px 0 rgba(0,0,0,0.25);">
            <div class="flex justify-between items-center self-stretch flex-grow-0 flex-shrink-0 h-[34px] relative p-2.5">
                <a href="../home/main" class="cursor-pointer">
                    <img src="/images/ë¡œê³ .png" class="flex-grow-0 flex-shrink-0 w-[140px] h-[55px] object-cover"/>
                </a>
                <div class="flex justify-start items-center flex-grow-0 flex-shrink-0 relative overflow-hidden py-6">

                    <p class="flex-grow-0 flex-shrink-0 text-base text-left text-[#1a1717]/[0.53]">
                        English (UK)
                    </p>
                    <svg
                            width="17"
                            height="18"
                            viewBox="0 0 17 18"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                            class="flex-grow-0 flex-shrink-0 w-4 h-4 relative"
                            preserveAspectRatio="none"
                    >
                        <g clip-path="url(#clip0_34_35)">
                            <path
                                    fill-rule="evenodd"
                                    clip-rule="evenodd"
                                    d="M9.50432 15.4628C9.39968 15.6319 9.25228 15.7704 9.07701 15.8643C8.90174 15.9581 8.7048 16.0041 8.50608 15.9975C8.30736 15.9909 8.11389 15.932 7.94521 15.8268C7.77654 15.7215 7.63862 15.5736 7.54539 15.398L1.0783 3.51042C0.647305 2.71772 1.22874 1.74743 2.11625 1.77682L15.8237 2.23076C16.7122 2.26018 17.2272 3.26778 16.7447 4.02922L9.50432 15.4628Z"
                                    fill="#1A1717"
                                    fill-opacity="0.38"
                            ></path>
                        </g>
                        <defs>
                            <clipPath id="clip0_34_35">
                                <rect
                                        width="16"
                                        height="16"
                                        fill="white"
                                        transform="translate(16.4705 17.2604) rotate(-178.103)"
                                ></rect>
                            </clipPath>
                        </defs>
                    </svg>
                </div>
            </div>
            <div class="flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-2.5 pl-[25px] pr-2.5 py-2.5">
                <p class="flex-grow w-[572px] text-2xl font-bold text-left text-[#181818]">
                    Create Account
                </p>
            </div>
            <div class="flex justify-center items-center h-[90px] gap-[10px]">
                <!-- ì¹´ì¹´ì˜¤ -->
                <a href="../member/loginKakao" class="flex-1 flex justify-center">
                    <img src="/images/ì¹´ì¹´ì˜¤ë¡œê·¸ì¸.png"
                         class="h-[40px] w-auto object-contain cursor-pointer" />
                </a>

                <!-- ë„¤ì´ë²„ -->
                <a href="../member/loginNaver" class="flex-1 flex justify-center">
                    <img src="/images/ë„¤ì´ë²„ë¡œê·¸ì¸.png"
                         class="h-[40px] w-auto object-contain cursor-pointer" />
                </a>

                <!-- êµ¬ê¸€ -->
                <div class="flex-1 flex justify-center">
                    <button onclick="googleLogin()"
                            class="flex items-center justify-center w-[183px] h-[40px] px-4 rounded border border-[#747775] bg-white shadow-sm cursor-pointer">
                        <!-- ì•„ì´ì½˜ -->
                        <div class="w-4 h-4 mr-2">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="w-full h-full">
                                <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                                <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                                <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                                <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                                <path fill="none" d="M0 0h48v48H0z"></path>
                            </svg>
                        </div>
                        <!-- í…ìŠ¤íŠ¸ -->
                        <span class="flex-grow text-[14px] leading-[20px] font-['Roboto',_arial,_sans-serif] align-top text-[#1f1f1f]">Sign in with Google</span>
                    </button>
                </div>
            </div>
            <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 w-[91px] relative gap-2.5 p-2.5 bg-white">
                <p class="flex-grow w-[71px] text-2xl font-bold text-left text-[#1a1717]/[0.38]">-OR-</p>
            </div>

            <form action="createAccount" method="post" id="createAccountForm">
                <div class="flex flex-col justify-start items-end flex-grow-0 flex-shrink-0 w-[546px] overflow-hidden gap-[40px] px-[22px] py-[13px]">

                    <div class=" flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="text" placeholder="Full Name" autocomplete="off" name="name" id="name"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-left text-2xl outline-none focus:outline-none focus:border-none"/>

                            <svg
                                    id="nameLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >

                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>
                        </label>

                        <div class="nameCheck-msg text-red-500 mt-2 flex hidden w-[502px]"></div>

                    </div>
                    <div class=" flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="text" placeholder="Email Address" autocomplete="off" name="email" id="email"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-xl text-left text-2xl outline-none focus:outline-none focus:border-none"/>

                            <svg
                                    id="emailLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >
                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>

                        </label>
                        <div class="emailCheck-msg text-red-500 mt-2 flex hidden w-[502px]"></div>
                    </div>
                    <div class=" flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="password" placeholder="Password" name="loginPw" id="joinPw" autocomplete="off"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-xl text-left text-2xl outline-none focus:outline-none focus:border-none"/>

                            <svg
                                    id="passwordLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >
                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>

                        </label>
                        <div class="passwordCheck-msg text-red-500 mt-2 flex hidden w-[502px]"></div>
                        <i onClick="showPassword(this);"
                           class="fa-solid fa-eye absolute top-0 right-0 text-2xl cursor-pointer"></i>
                    </div>

                    <div class="flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="text" placeholder="PhoneNumber" name="phoneNum" autocomplete="off"
                                   maxlength="13"
                                   id="phoneNum"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-xl text-left text-2xl outline-none focus:outline-none focus:border-none"
                            />

                            <svg
                                    id="phoneNumLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >
                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>

                        </label>

                        <div class="phoneNumCheck-msg text-red-500 mt-2 flex hidden w-[502px]"></div>
                    </div>

                </div>
            </form>
            <button form="createAccountForm" onClick="handleSubmit(event);"
                    class="flex justify-start items-start flex-grow-0 flex-shrink-0 w-[502px] h-12 relative gap-2.5 p-2.5 rounded-lg bg-[#279574] cursor-pointer">
                <p class="flex-grow w-[482px] text-xl font-semibold text-center text-white ">
                    Create Account
                </p>
            </button>

            <div onClick="toggleDiv();"
                 class="flex justify-center items-center flex-grow-0 flex-shrink-0 w-[350px] h-11 relative gap-2.5 p-2.5 cursor-pointer">
                <p class="flex-grow w-[310px] text-xl font-medium text-center">
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-black/30">Already have an account ?</span>
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-black/[0.12]"></span>
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-[#54beb8]">Sign Up</span>
                </p>
            </div>
        </div>

        <div class="loginDiv flex flex-col justify-center items-center w-[607px] absolute translate-y-[95px] left-[719px] gap-[30px] py-[11px] top-2.5 rounded-tl-3xl rounded-bl-3xl bg-white"
             style="box-shadow: 4px 4px 4px 0 rgba(0,0,0,0.25);">
            <div class="flex justify-between items-center self-stretch flex-grow-0 flex-shrink-0 h-[34px] relative p-2.5">
                <a href="../home/main" class="cursor-pointer">
                    <img src="/images/ë¡œê³ .png"
                         class="flex-grow-0 flex-shrink-0 w-[140px] h-[55px] object-cover"/>
                </a>
                <div class="flex justify-start items-center flex-grow-0 flex-shrink-0 relative overflow-hidden py-6">
                    <p class="flex-grow-0 flex-shrink-0 text-base text-left text-[#1a1717]/[0.53]">
                        English (UK)
                    </p>
                    <svg
                            width="17"
                            height="18"
                            viewBox="0 0 17 18"
                            fill="none"
                            xmlns="http://www.w3.org/2000/svg"
                            class="flex-grow-0 flex-shrink-0 w-4 h-4 relative"
                            preserveAspectRatio="none"
                    >
                        <g clip-path="url(#clip0_34_35)">
                            <path
                                    fill-rule="evenodd"
                                    clip-rule="evenodd"
                                    d="M9.50432 15.4628C9.39968 15.6319 9.25228 15.7704 9.07701 15.8643C8.90174 15.9581 8.7048 16.0041 8.50608 15.9975C8.30736 15.9909 8.11389 15.932 7.94521 15.8268C7.77654 15.7215 7.63862 15.5736 7.54539 15.398L1.0783 3.51042C0.647305 2.71772 1.22874 1.74743 2.11625 1.77682L15.8237 2.23076C16.7122 2.26018 17.2272 3.26778 16.7447 4.02922L9.50432 15.4628Z"
                                    fill="#1A1717"
                                    fill-opacity="0.38"
                            ></path>
                        </g>
                        <defs>
                            <clipPath id="clip0_34_35">
                                <rect
                                        width="16"
                                        height="16"
                                        fill="white"
                                        transform="translate(16.4705 17.2604) rotate(-178.103)"
                                ></rect>
                            </clipPath>
                        </defs>
                    </svg>
                </div>
            </div>
            <div class="flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-2.5 pl-[25px] pr-2.5 py-2.5">
                <p class="flex-grow w-[572px] text-2xl font-bold text-left text-[#181818]">
                    Sign Up
                </p>
            </div>
            <div class="flex justify-center items-center h-[90px] gap-[10px]">
                <!-- ì¹´ì¹´ì˜¤ -->
                <a href="../member/loginKakao" class="flex-1 flex justify-center">
                    <img src="/images/ì¹´ì¹´ì˜¤ë¡œê·¸ì¸.png"
                         class="h-[40px] w-auto object-contain cursor-pointer" />
                </a>

                <!-- ë„¤ì´ë²„ -->
                <a href="../member/loginNaver" class="flex-1 flex justify-center">
                    <img src="/images/ë„¤ì´ë²„ë¡œê·¸ì¸.png"
                         class="h-[40px] w-auto object-contain cursor-pointer" />
                </a>

                <!-- êµ¬ê¸€ -->
                <div class="flex-1 flex justify-center">
                    <button onclick="googleLogin()"
                            class="flex items-center justify-center w-[183px] h-[40px] px-4 rounded border border-[#747775] bg-white shadow-sm cursor-pointer">
                        <!-- ì•„ì´ì½˜ -->
                        <div class="w-4 h-4 mr-2">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="w-full h-full">
                                <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path>
                                <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path>
                                <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path>
                                <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path>
                                <path fill="none" d="M0 0h48v48H0z"></path>
                            </svg>
                        </div>
                        <!-- í…ìŠ¤íŠ¸ -->
                        <span class="flex-grow text-[14px] leading-[20px] font-['Roboto',_arial,_sans-serif] align-top text-[#1f1f1f]">Sign in with Google</span>
                    </button>
                </div>
            </div>
            <div class="flex justify-start items-start flex-grow-0 flex-shrink-0 w-[91px] relative gap-2.5 p-2.5 bg-white">
                <p class="flex-grow w-[71px] text-2xl font-bold text-left text-[#1a1717]/[0.38]">-OR-</p>
            </div>
            <form action="doLogin" method="post" id="loginForm">
                <div class="flex flex-col justify-start items-end flex-grow-0 flex-shrink-0 w-[546px] overflow-hidden gap-[40px] px-[22px] py-[13px]">

                    <div class=" flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="text" placeholder="Email Address" autocomplete="off" name="username"
                                   id="loginEmail"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-xl text-left text-2xl outline-none focus:outline-none focus:border-none"/>

                            <svg
                                    id="emailLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >
                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>

                        </label>
                    </div>
                    <div class=" flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 h-12 relative">
                        <label>
                            <input type="password" placeholder="Password" name="password" id="loginPw"
                                   autocomplete="off"
                                   class="self-stretch flex-grow-0 flex-shrink-0 w-[502px] text-xl text-left text-2xl outline-none focus:outline-none focus:border-none"/>

                            <svg
                                    id="passwordLine"
                                    width="503"
                                    height="2"
                                    viewBox="0 0 503 2"
                                    fill="none"
                                    xmlns="http://www.w3.org/2000/svg"
                                    class="flex-grow-0 flex-shrink-0"
                                    preserveAspectRatio="none"
                            >
                                <path d="M0.5 1H502.5" stroke="#1A1717" stroke-opacity="0.38"></path>
                            </svg>

                        </label>
                        <i onClick="showPassword(this);" class="fa-solid fa-eye absolute top-0 right-0 text-2xl cursor-pointer"></i>
                    </div>
                </div>
            </form>

            <button form="loginForm" onClick="handleLoginSubmit(event);"
                    class="flex justify-start items-start flex-grow-0 flex-shrink-0 w-[502px] h-12 relative gap-2.5 p-2.5 rounded-lg bg-[#279574] cursor-pointer">
                <p class="flex-grow w-[482px] text-xl font-semibold text-center text-white ">
                    Sign Up
                </p>
            </button>

            <div onClick="toggleDiv();"
                 class="flex justify-center items-center flex-grow-0 flex-shrink-0  w-[400px] h-11 relative gap-2.5 p-2.5 cursor-pointer">
                <p class="flex-grow w-[310px] text-xl font-medium text-center">
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-black/30">Don't Have an Account?</span>
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-black/[0.12]"></span>
                    <span class="flex-grow w-[310px] text-xl font-medium text-center text-[#54beb8]">Create Account</span>
                </p>
            </div>
        </div>
    </div>
</div>

<!-- êµ¬ê¸€ ë¡œê·¸ì¸ -->
<script type="module">
    import {initializeApp} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import {
        getAuth,
        GoogleAuthProvider,
        signInWithPopup
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

    // âœ… Firebase ì„¤ì •
    const firebaseConfig = {
        apiKey: "AIzaSyDqY-Lj2sJliSi2FOF-nwXf5d99lrlWyMs",
        authDomain: "tmrteamproject.firebaseapp.com",
        projectId: "tmrteamproject",
        storageBucket: "tmrteamproject.firebasestorage.app",
        messagingSenderId: "1042006957683",
        appId: "1:1042006957683:web:7aa5565d3dacc30fda5406",
        measurementId: "G-RE253T3ZQY"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);


    // âœ… êµ¬ê¸€ ë¡œê·¸ì¸ í•¨ìˆ˜
    // âœ… Google ë¡œê·¸ì¸ í•¨ìˆ˜
    window.googleLogin = async () => {
        const provider = new GoogleAuthProvider();

        // ğŸ”’ ê¸°ë³¸ ë° ë¯¼ê°í•œ ì •ë³´ scope ì¶”ê°€
        provider.addScope('profile');
        provider.addScope('email');
        provider.addScope('https://www.googleapis.com/auth/user.phonenumbers.read');

        provider.setCustomParameters({prompt: 'select_account'});

        try {
            const result = await signInWithPopup(auth, provider);

            const user = result.user;
            console.log("âœ… ë¡œê·¸ì¸ ì„±ê³µ:", user);

            // âœ… Firebase idToken â†’ ì„œë²„ ì „ì†¡ (ì„ íƒ)
            const idToken = await user.getIdToken();

            const token = await user.getIdTokenResult();
            console.log(token.claims);
            console.log(token.signInProvider);
            // âœ… accessToken â†’ Google People API í˜¸ì¶œ
            const credential = GoogleAuthProvider.credentialFromResult(result);
            const accessToken = credential.accessToken;

            const profile = await fetchGoogleProfileData(accessToken);

            if (profile) {
                console.log("ğŸ™‹ ìœ ì € ì´ë¦„:", profile.name);
                console.log("ğŸ“§ ì´ë©”ì¼:", profile.email);
                console.log("ğŸ“ ì „í™”ë²ˆí˜¸:", profile.phone);
                console.log("ğŸ–¼ï¸ í”„ë¡œí•„ ì´ë¯¸ì§€:", profile.photoUrl);
                sendTokenToServer(idToken, profile);
            }
        } catch (error) {
            console.error("âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:", error);
        }
    };

    async function fetchGoogleProfileData(accessToken) {
        try {
            const response = await fetch(
                "https://people.googleapis.com/v1/people/me?personFields=names,emailAddresses,birthdays,phoneNumbers,photos",
                {
                    headers: {
                        Authorization: `Bearer ${accessToken}`
                    }
                }
            );

            if (!response.ok) {
                throw new Error("Google API í˜¸ì¶œ ì‹¤íŒ¨: " + response.statusText);
            }

            const data = await response.json();
            console.log("âœ… People API ì‘ë‹µ:", data);

            // âœ… ì›í•˜ëŠ” ì •ë³´ íŒŒì‹±
            const name = data.names?.[0]?.displayName || "ì´ë¦„ ì—†ìŒ";
            const email = data.emailAddresses?.[0]?.value || "ì´ë©”ì¼ ì—†ìŒ";
            const birthday = data.birthdays?.[0]?.date || null;
            const phone = data.phoneNumbers?.[0]?.value || "ì „í™”ë²ˆí˜¸ ì—†ìŒ";
            const photoUrl = data.photos?.[0]?.url || null;

            return {
                name,
                email,
                birthday,
                phone,
                photoUrl
            };
        } catch (err) {
            console.error("âŒ Google People API ì˜¤ë¥˜:", err);
            return null;
        }
    }


    // âœ… ì„œë²„ë¡œ í† í° ì „ì†¡
    function sendTokenToServer(idToken, profile) {
        fetch("http://localhost:8080/usr/member/googleCallback", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idToken,
                name: profile.name,
                email: profile.email,
                phone: profile.phone,
                photoUrl: profile.photoUrl
            })  // âœ… ì—¬ê¸°ì— idToken ì¶”ê°€
        })
            .then(res => {
                if (!res.ok) throw new Error("ì„œë²„ ì‘ë‹µ ì‹¤íŒ¨");
                return res.text();
            })
            .then(result => {
                console.log("âœ… ì„œë²„ ì‘ë‹µ:", result);
                // âœ… ë¦¬ë””ë ‰ì…˜ ì‹¤í–‰
                window.location.href = "/usr/home/main";  // ì›í•˜ëŠ” ê²½ë¡œë¡œ ìˆ˜ì •
            })
            .catch(err => {
                console.error("âŒ ì„œë²„ ìš”ì²­ ì‹¤íŒ¨:", err);
                alert("ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            });
    }


    window.deleteAccount = () => {
        const user = auth.currentUser;

        if (user) {
            const confirmDelete = confirm("ì •ë§ë¡œ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\në³µêµ¬ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.");
            if (!confirmDelete) return;

            user.delete()
                .then(() => {
                    alert("âœ… ê³„ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
                    console.log("âœ… Firebase ì‚¬ìš©ì ì‚­ì œ ì™„ë£Œ");
                })
                .catch((error) => {
                    console.error("âŒ ê³„ì • ì‚­ì œ ì‹¤íŒ¨:", error);

                    // ğŸ”‘ ì˜ˆì™¸: ìµœê·¼ ë¡œê·¸ì¸ í•„ìš”
                    if (error.code === 'auth/requires-recent-login') {
                        alert("ğŸ” ë³´ì•ˆì„ ìœ„í•´ ìµœê·¼ ë¡œê·¸ì¸ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
                    } else {
                        alert("ê³„ì • ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                    }
                });
        } else {
            alert("âŒ í˜„ì¬ ë¡œê·¸ì¸ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤.");
        }
    };

</script>
